<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдбреЗрдЯрд╛ рдПрдВрдЯреНрд░реА рдлреЙрд░реНрдо</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* рдЗрдВрдЯрд░ рдлрд╝реЙрдиреНрдЯ рд▓реЛрдб рдХрд░реЗрдВ */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* рд╣рд▓реНрдХрд╛ рдиреАрд▓рд╛ рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб */
        }
        .modal {
            display: none;
        }
        .modal-active {
            display: flex;
        }
    </style>
</head>
<body class="p-4 md:p-8 flex items-center justify-center min-h-screen">

    <!-- Modal for Messages -->
    <!-- z-index: 50 рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рддрд╛рдХрд┐ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рд╣реЛ рд╕рдХреЗ рдХрд┐ рдпрд╣ рд╣рдореЗрд╢рд╛ рд╕рдмрд╕реЗ рдКрдкрд░ рджрд┐рдЦреЗред -->
    <div id="statusModal" class="modal fixed inset-0 z-50 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full items-center justify-center">
        <div class="relative p-8 w-full max-w-sm m-auto bg-white rounded-xl shadow-lg">
            <div class="text-center">
                <div id="modalIcon" class="mx-auto text-4xl mb-4"></div>
                <h3 id="modalTitle" class="text-lg leading-6 font-medium text-gray-900 mb-2"></h3>
                <p id="modalMessage" class="text-sm text-gray-500"></p>
                <div class="mt-4 flex justify-center">
                    <button type="button" onclick="closeModal()" class="px-4 py-2 bg-blue-600 text-white text-base font-medium rounded-md shadow-sm hover:bg-blue-700 focus:outline-none">рдареАрдХ рд╣реИ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Form Container -->
    <div class="bg-white p-6 md:p-8 rounded-2xl shadow-2xl max-w-lg w-full transform transition-all duration-300 hover:scale-[1.01]">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-6 border-b-2 pb-4">рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдбреЗрдЯрд╛ рдПрдВрдЯреНрд░реА рдлреЙрд░реНрдо</h1>
        
        <form id="installationForm" class="space-y-6">
            <!-- рд╕реНрдЯреЗрдк 1: рд▓реЛрдХреЗрд╢рди рдЪреБрдиреЗрдВ -->
            <div>
                <h2 class="text-xl font-semibold text-gray-700 mb-4">ЁЯФ╣ рд╕реНрдЯреЗрдк 1: рд▓реЛрдХреЗрд╢рди рдЪреБрдиреЗрдВ</h2>
                <div class="space-y-2">
                    <label for="district" class="block text-sm font-medium text-gray-700">рдЬрд┐рд▓рд╛/рддрд╣рд╕реАрд▓</label>
                    <select id="district" name="рдЬрд┐рд▓рд╛/рддрд╣рд╕реАрд▓" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                        <option value="">-- рдЬрд┐рд▓рд╛/рддрд╣рд╕реАрд▓ рдЪреБрдиреЗрдВ --</option>
                    </select>
                </div>
            </div>

            <!-- рд╕реНрдЯреЗрдк 2: рд╡рд┐рджреНрдпрд╛рд▓рдп рдЪреБрдиреЗрдВ -->
            <div>
                <h2 class="text-xl font-semibold text-gray-700 mb-4">ЁЯФ╣ рд╕реНрдЯреЗрдк 2: рд╡рд┐рджреНрдпрд╛рд▓рдп рдЪреБрдиреЗрдВ</h2>
                <div class="space-y-2">
                    <label for="school" class="block text-sm font-medium text-gray-700">рд╡рд┐рджреНрдпрд╛рд▓рдп</label>
                    <select id="school" name="рд╡рд┐рджреНрдпрд╛рд▓рдп" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150" disabled>
                        <option value="">-- рдкрд╣рд▓реЗ рд▓реЛрдХреЗрд╢рди рдЪреБрдиреЗрдВ --</option>
                    </select>
                </div>
            </div>

            <!-- рд╕реНрдЯреЗрдк 3: рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рд╡рд┐рд╡рд░рдг рднрд░реЗрдВ -->
            <div>
                <h2 class="text-xl font-semibold text-gray-700 mb-4">ЁЯФ╣ рд╕реНрдЯреЗрдк 3: рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рд╡рд┐рд╡рд░рдг рднрд░реЗрдВ</h2>
                <div class="space-y-4">
                    <!-- рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдХреА рддрд╛рд░реАрдЦ -->
                    <div>
                        <label for="installDate" class="block text-sm font-medium text-gray-700">ЁЯУЕ рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдХреА рддрд╛рд░реАрдЦ</label>
                        <input type="date" id="installDate" name="рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдХреА рддрд╛рд░реАрдЦ" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                    </div>

                    <!-- рдмреЛрд░реНрдб рдХрд╛ рдореЙрдбрд▓ рдирдВрдмрд░ -->
                    <div>
                        <label for="modelNumber" class="block text-sm font-medium text-gray-700">ЁЯз╛ рдмреЛрд░реНрдб рдХрд╛ рдореЙрдбрд▓ рдирдВрдмрд░</label>
                        <input type="text" id="modelNumber" name="рдмреЛрд░реНрдб рдХрд╛ рдореЙрдбрд▓ рдирдВрдмрд░" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150" placeholder="рдореЙрдбрд▓ рдирдВрдмрд░ рджрд░реНрдЬ рдХрд░реЗрдВ">
                    </div>

                    <!-- рдореЙрдбрд▓ рдирдВрдмрд░ рдХреА рдлреЛрдЯреЛ -->
                    <!-- Note: For simplicity, photo fields will not be handled by the script. They would require more complex server-side logic to upload files. We'll add a note for the user. -->
                    <div>
                        <label for="modelPhoto" class="block text-sm font-medium text-gray-700">ЁЯУ╕ рдореЙрдбрд▓ рдирдВрдмрд░ рдХреА рдлреЛрдЯреЛ</label>
                        <input type="file" id="modelPhoto" name="рдореЙрдбрд▓ рдирдВрдмрд░ рдХреА рдлреЛрдЯреЛ" accept="image/*" capture="camera" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                    </div>
                    
                    <!-- рд╕реАрд░рд┐рдпрд▓ рдирдВрдмрд░ -->
                    <div>
                        <label for="serialNumber" class="block text-sm font-medium text-gray-700">ЁЯФв рд╕реАрд░рд┐рдпрд▓ рдирдВрдмрд░</label>
                        <input type="text" id="serialNumber" name="рд╕реАрд░рд┐рдпрд▓ рдирдВрдмрд░" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150" placeholder="рд╕реАрд░рд┐рдпрд▓ рдирдВрдмрд░ рджрд░реНрдЬ рдХрд░реЗрдВ">
                    </div>
                    
                    <!-- рд╕реАрд░рд┐рдпрд▓ рдирдВрдмрд░ рдХреА рдлреЛрдЯреЛ -->
                    <div>
                        <label for="serialPhoto" class="block text-sm font-medium text-gray-700">ЁЯУ╕ рд╕реАрд░рд┐рдпрд▓ рдирдВрдмрд░ рдХреА рдлреЛрдЯреЛ</label>
                        <input type="file" id="serialPhoto" name="рд╕реАрд░рд┐рдпрд▓ рдирдВрдмрд░ рдХреА рдлреЛрдЯреЛ" accept="image/*" capture="camera" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                    </div>
                    
                    <!-- рдмреЛрд░реНрдб рдХреА рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдХреЗ рдмрд╛рдж рдХреА рдлреЛрдЯреЛ -->
                    <div>
                        <label for="postInstallPhoto" class="block text-sm font-medium text-gray-700">ЁЯУ╕ рдмреЛрд░реНрдб рдХреА рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдХреЗ рдмрд╛рдж рдХреА рдлреЛрдЯреЛ</label>
                        <input type="file" id="postInstallPhoto" name="рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдХреЗ рдмрд╛рдж рдХреА рдлреЛрдЯреЛ" accept="image/*" capture="camera" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                    </div>
                    
                    <!-- рдЯрд┐рдкреНрдкрдгреА -->
                    <div>
                        <label for="comment" class="block text-sm font-medium text-gray-700">ЁЯУЭ рдЯрд┐рдкреНрдкрдгреА</label>
                        <textarea id="comment" name="рдЯрд┐рдкреНрдкрдгреА" rows="4" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150" placeholder="рдХреЛрдИ рд╡рд┐рд╢реЗрд╖ рдмрд╛рдд рдпрд╣рд╛рдБ рд▓рд┐рдЦреЗрдВ"></textarea>
                    </div>

                    <!-- GPS рд▓реЛрдХреЗрд╢рди -->
                    <div>
                        <label for="gpsLocation" class="block text-sm font-medium text-gray-700">ЁЯУН GPS рд▓реЛрдХреЗрд╢рди</label>
                        <div class="flex space-x-2">
                            <input type="text" id="gpsLocation" name="GPS рд▓реЛрдХреЗрд╢рди" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 bg-gray-50" readonly placeholder="рд▓реЛрдХреЗрд╢рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ">
                            <button type="button" id="getGpsButton" class="px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 transform hover:scale-105">рд▓реЛрдХреЗрд╢рди рдкрд╛рдПрдВ</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <button type="submit" id="submitButton" class="w-full py-3 px-4 bg-green-600 text-white font-semibold rounded-lg shadow-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-150 transform hover:scale-105">
                рдбреЗрдЯрд╛ рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВ
            </button>
        </form>
    </div>

    <!-- JavaScript for dynamic functionality -->
    <script>
        // рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП CSV рдбреЗрдЯрд╛ рд╕реЗ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╕реНрдХреВрд▓ рдбреЗрдЯрд╛
        const schoolData = {
            "LADNUN": ["GSSS CHHAPPARA", "GSSS DHINGSARI", "GSSS DHOLIYA", "GSSS HEERAWATI", "GSSS KHAMIYESAD", "GSSS MANGALPURA", "GGSSS SMT KESAR DEVI SETHI", "SWAMI VIVEKANAND GMS,NIMBI", "MGGS RATAU", "GUPS GHIRDODA KHARA", "GUPS NO 4 LADNUN", "GGSSS MEETHRI", "GUPS No. 5 RAMLAL MUNDRA", "GSSS MEENDASARI", "MGGS BALDU", "GSSS BHIDASARI LADNUN", "GUPS NO 9 MAGRA BASS", "GSSS VISHWANATHPURA SUNARI", "GSSS KHEENWAJ", "MGGS MEETHRI"],
            "SUJANGARH": ["MGM SHOBHASAR", "GSSS MALSISAR", "GSSS CHANDGOTHRI", "GSSS MEGHWALO KI DHANI", "GSSS BUDKIYA", "GSSS JAJUSAR", "GSSS KHYALI", "GGSSS SUJANGARH", "GSSS JELI", "GSSS JOGALIYA", "GGSSS CHARNIYA", "GSSS RAMPURA BASINDA", "GGSSS DUNGARWALO KA BAS", "GSSS RATAU"],
            "NAGAUR": ["GVUSS LAMBA JATAN", "GVUSS SAINSARA", "GPRASS JIYA RAM KI JHOPARI", "GPRASS TAUSAR", "GVUSS BADAYALI", "GVUSS TANTWAS", "GVUSS MOGAS", "GPSS DODU", "GVUSS MARWAR MUNDWA"],
            "AJMER": ["GPRASS KOTRA", "GVUSS GANJ AJMER", "GVUSS PRATAP NAGAR AJMER", "GVUSS SHIVAJI NAGAR KISHANGARH", "GUPSS PUSHKAR"],
            "DK": ["GPRSS PEEH", "GVUSS DIDWANA", "MGGS GACHHIPURA"],
            "TONK": ["GVUSS GALOD", "GVUSS MEENO KI JHOPDI ,BANETHA"],
            "KEKRI": ["GVUSS SAWAR"],
            "BEAWAR": ["GVUSS BIJAYNAGAR", "GVUSS SENDRA"],
            "BHILWARA": ["GVUSS HAMEERGARH", "GVUSS MAANDAL", "GVUSS KHJEENA"],
            "SHAHPURA": ["GVUSS PANDER", "GPSS PEEPLI"]
        };

        const form = document.getElementById('installationForm');
        const districtSelect = document.getElementById('district');
        const schoolSelect = document.getElementById('school');
        const installDateInput = document.getElementById('installDate');
        const getGpsButton = document.getElementById('getGpsButton');
        const gpsLocationInput = document.getElementById('gpsLocation');
        const submitButton = document.getElementById('submitButton');
        
        // **рдпрд╣рд╛рдВ рдЕрдкрдирд╛ Google Apps Script рд╡реЗрдм рдРрдк URL рдбрд╛рд▓реЗрдВ**
        // рдпрд╣ URL рдЖрдкрдХреЛ Google Apps Script рдХреЛ рдбрд┐рдкреНрд▓реЙрдп рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдорд┐рд▓реЗрдЧрд╛ред
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyGwpuzSCAHS14bcbg9VL8rvwqiLU1kMvvcIwn91Z4eMyb2_SKhclNdSewSdz-fz2LRDg/exec';

        // рдореЙрдбрд▓ рдлрд╝рдВрдХреНрд╢рдВрд╕
        function showModal(title, message, icon) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalMessage').textContent = message;
            document.getElementById('modalIcon').textContent = icon;
            document.getElementById('statusModal').classList.add('modal-active');
        }

        function closeModal() {
            document.getElementById('statusModal').classList.remove('modal-active');
        }

        // рдЬрдм DOM рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд▓реЛрдб рд╣реЛ рдЬрд╛рдП рддреЛ рдпрд╣ рдлрд╝рдВрдХреНрд╢рди рдЪрд▓реЗрдЧрд╛
        window.addEventListener('DOMContentLoaded', () => {
            const today = new Date();
            const yyyy = today.getFullYear();
            const mm = String(today.getMonth() + 1).padStart(2, '0');
            const dd = String(today.getDate()).padStart(2, '0');
            installDateInput.value = `${yyyy}-${mm}-${dd}`;
            
            const sortedDistricts = Object.keys(schoolData).sort();
            sortedDistricts.forEach(district => {
                const option = document.createElement('option');
                option.value = district;
                option.textContent = district;
                districtSelect.appendChild(option);
            });
        });

        // 'рдЬрд┐рд▓рд╛/рддрд╣рд╕реАрд▓' рдбреНрд░реЙрдкрдбрд╛рдЙрди рдореЗрдВ рдмрджрд▓рд╛рд╡ рд╣реЛрдиреЗ рдкрд░
        districtSelect.addEventListener('change', (event) => {
            const selectedDistrict = event.target.value;
            schoolSelect.innerHTML = '<option value="">-- рд╡рд┐рджреНрдпрд╛рд▓рдп рдЪреБрдиреЗрдВ --</option>';
            schoolSelect.disabled = true;

            if (selectedDistrict) {
                const schools = schoolData[selectedDistrict];
                const sortedSchools = schools.sort();
                sortedSchools.forEach(school => {
                    const option = document.createElement('option');
                    option.value = school;
                    option.textContent = school;
                    schoolSelect.appendChild(option);
                });
                schoolSelect.disabled = false;
            }
        });

        // 'рд▓реЛрдХреЗрд╢рди рдкрд╛рдПрдВ' рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдкрд░
        getGpsButton.addEventListener('click', () => {
            // HTTPS рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд▓рд┐рдП рдЪреЗрдХ рдХрд░реЗрдВ
            if (window.location.protocol !== 'https:') {
                showModal('рддреНрд░реБрдЯрд┐!', 'GPS рд▓реЛрдХреЗрд╢рди рдХреЗрд╡рд▓ рд╕реБрд░рдХреНрд╖рд┐рдд HTTPS рдХрдиреЗрдХреНрд╢рди рдкрд░ рдХрд╛рдо рдХрд░рддреА рд╣реИред рдХреГрдкрдпрд╛ рдЗрд╕ рдлреЙрд░реНрдо рдХреЛ рдПрдХ рд▓рд╛рдЗрд╡ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВред', 'тЭМ');
                return;
            }

            if (navigator.geolocation) {
                getGpsButton.textContent = 'рд▓реЛрдХреЗрд╢рди рд▓реЗ рд░рд╣рд╛ рд╣реИ...';
                getGpsButton.disabled = true;
                
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const latitude = position.coords.latitude;
                        const longitude = position.coords.longitude;
                        gpsLocationInput.value = `${latitude}, ${longitude}`;
                        getGpsButton.textContent = 'рд▓реЛрдХреЗрд╢рди рд▓реА рдЧрдИ';
                        getGpsButton.disabled = false;
                    },
                    (error) => {
                        console.error("GPS рд▓реЛрдХреЗрд╢рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рддреНрд░реБрдЯрд┐:", error);
                        gpsLocationInput.value = 'рд▓реЛрдХреЗрд╢рди рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛ рд╕рдХреАред';
                        getGpsButton.textContent = 'рд▓реЛрдХреЗрд╢рди рдкрд╛рдПрдВ';
                        getGpsButton.disabled = false;
                        let errorMessage = 'рд▓реЛрдХреЗрд╢рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рддреНрд░реБрдЯрд┐ рд╣реБрдИред';
                        if (error.code === error.PERMISSION_DENIED) {
                            errorMessage = 'рдХреГрдкрдпрд╛ рд▓реЛрдХреЗрд╢рди рдПрдХреНрд╕реЗрд╕ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдВред';
                        }
                        showModal('рддреНрд░реБрдЯрд┐!', errorMessage, 'тЭМ');
                    }, {
                        enableHighAccuracy: true,
                        timeout: 5000,
                        maximumAge: 0
                    }
                );
            } else {
                showModal('рдЕрд╕рдорд░реНрдерд┐рдд рдмреНрд░рд╛рдЙрдЬрд╝рд░', 'рдЖрдкрдХрд╛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ GPS рд▓реЛрдХреЗрд╢рди рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред', 'тЪая╕П');
            }
        });

        // рдлреЙрд░реНрдо рд╕рдмрдорд┐рдЯ рд╣реЛрдиреЗ рдкрд░
        form.addEventListener('submit', async (event) => {
            event.preventDefault();

            if (SCRIPT_URL === 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE') {
                showModal('рддреНрд░реБрдЯрд┐!', 'рдХреГрдкрдпрд╛ рдЕрдкрдирд╛ Google Apps Script URL рдХреЛрдб рдореЗрдВ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВред', 'тЪая╕П');
                return;
            }

            submitButton.disabled = true;
            submitButton.textContent = 'рдбреЗрдЯрд╛ рд╕рдмрдорд┐рдЯ рд╣реЛ рд░рд╣рд╛ рд╣реИ...';

            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            
            // Photo fields are not handled in this basic example for simplicity.
            // A more complex setup is required for file uploads to Google Drive.
            
            try {
                // Fetch call to send the data
                await fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors', // Important for cross-origin requests
                    cache: 'no-cache',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: new URLSearchParams(data)
                });
                
                // Since `no-cors` mode doesn't allow reading the server's response,
                // we'll assume success if the fetch call doesn't throw a network error.
                showModal('рд╕рдлрд▓рддрд╛!', 'рдЖрдкрдХрд╛ рдбреЗрдЯрд╛ Google Sheet рдореЗрдВ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд╕реЗрд╡ рд╣реЛ рдЧрдпрд╛ рд╣реИред', 'тЬЕ');
                form.reset(); // Reset the form after successful submission
                // Resetting the date to today's date after form reset
                const today = new Date();
                const yyyy = today.getFullYear();
                const mm = String(today.getMonth() + 1).padStart(2, '0');
                const dd = String(today.getDate()).padStart(2, '0');
                installDateInput.value = `${yyyy}-${mm}-${dd}`;
                
            } catch (error) {
                console.error('Error submitting form:', error);
                showModal('рддреНрд░реБрдЯрд┐!', 'рдбреЗрдЯрд╛ рд╕рдмрдорд┐рдЯ рдХрд░рдиреЗ рдореЗрдВ рдХреЛрдИ рд╕рдорд╕реНрдпрд╛ рд╣реБрдИред рдХреГрдкрдпрд╛ рджреЛрдмрд╛рд░рд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред', 'тЭМ');
            } finally {
                submitButton.disabled = false;
                submitButton.textContent = 'рдбреЗрдЯрд╛ рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВ';
            }
        });
    </script>
</body>
</html>
